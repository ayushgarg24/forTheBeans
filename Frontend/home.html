<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>Wavlets</title>
</head>

<body>
	<script src="https://www.javapoly.com/javapoly.js"></script>
	<script type="text/java" src="https://storage.googleapis.com/stuffandthingsforstuff/jwave-1.0.3.jar"></script>
	<script type="text/java" src="https://storage.googleapis.com/stuffandthingsforstuff/commons-io-1.3.2.jar"></script>
	<script type="text/java" src="https://storage.googleapis.com/stuffandthingsforstuff/renjin-script-engine-0.9.2594-jar-with-dependencies.jar"></script>
	<script type="text/java" src="https://storage.googleapis.com/stuffandthingsforstuff/Operators.java"></script>
	<script type="text/java" src="https://storage.googleapis.com/stuffandthingsforstuff/Wave.java"></script>
	<script type="text/java">
		import com.javapoly.dom.Console;
	
		public class PlayAudio {
    		public static byte[] playSong() {
				Console.log("Java Method Called");
      			path = "http://storage.googleapis.com/stuffandthingsforstuff/ran.zip";
        		Wave song = null;
        		try {
            		song = new Wave(path);
        		} catch (IOException e) {
            		e.printStackTrace();
        		} catch (UnsupportedAudioFileException e) {
					e.printStackTrace();
        		}
				song.decompress();
        		return song.waveAsBytes;
    		}
  		}
	</script>
	<script type="text/javascript">
		console.log("Scipt Running");
  		var array = PlayAudio.playSong();
		var context;    // Audio context
		var buf;        // Audio buffer
		if (!window.AudioContext) {
			window.AudioContext = window.webkitAudioContext;
		}
		context = new AudioContext();
		
		function playByteArray( bytes ) {
    		var buffer = new Uint8Array( bytes.length );
    		buffer.set( new Uint8Array(bytes), 0 );

    		context.decodeAudioData(buffer.buffer, play);
		}

		function play( audioBuffer ) {
    		var source = context.createBufferSource();
    		source.buffer = audioBuffer;
    		source.connect( context.destination );
    		source.start(0);
		}
		
		playByteArray(array);
	</script>
</body>
</html>
